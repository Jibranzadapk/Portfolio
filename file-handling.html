<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HTML Viewer — View friend.html</title>
  <style>
    :root{
      --bg:#0f1724;
      --card:#0b1220;
      --accent:#7c3aed; /* purple */
      --muted:#93a3bf;
      --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,#071122 0%, #071826 60%);
      color:#e6eef8;
      padding:28px;
    }

    .wrap{
      width:100%;
      max-width:980px;
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:14px;
      padding:20px;
      box-shadow: 0 8px 30px rgba(2,6,23,0.6);
      border:1px solid rgba(255,255,255,0.03);
    }

    .head{
      display:flex;
      gap:12px;
      align-items:center;
      justify-content:space-between;
      margin-bottom:14px;
    }

    .title {
      display:flex;
      gap:12px;
      align-items:center;
    }
    .logo {
      width:44px;height:44px;border-radius:10px;
      background: linear-gradient(135deg,var(--accent), #06b6d4);
      display:grid;place-items:center;font-weight:700;color:white;
      box-shadow: 0 6px 20px rgba(124,58,237,0.18);
    }
    h1{font-size:16px;margin:0}
    p.small{margin:0;color:var(--muted);font-size:13px}

    .controls{
      display:flex;
      gap:10px;
      align-items:center;
    }

    .btn{
      background:linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      color: white;
      border: 1px solid rgba(255,255,255,0.06);
      padding:10px 14px;
      border-radius:10px;
      cursor:pointer;
      font-weight:600;
      display:inline-flex;
      gap:8px;
      align-items:center;
      transition:transform .12s ease, box-shadow .12s;
      user-select:none;
    }
    .btn:hover{ transform: translateY(-3px); box-shadow: 0 8px 30px rgba(2,6,23,0.6); }
    .btn.secondary{
      background:transparent;
      border:1px dashed rgba(255,255,255,0.04);
      color:var(--muted);
      font-weight:600;
    }

    /* code area */
    .info-row{ display:flex; justify-content:space-between; align-items:center; gap:12px; margin-bottom:10px; }
    .meta { color:var(--muted); font-size:13px; }
    .viewer{
      background: linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.01));
      border-radius:10px;
      padding:12px;
      border:1px solid rgba(255,255,255,0.03);
      min-height:260px;
      max-height:540px;
      overflow:auto;
      position:relative;
    }

    pre.code {
      margin:0;
      font-family: SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace;
      font-size:13px;
      line-height:1.5;
      white-space:pre;
      tab-size:2;
      color:#e6eef8;
      counter-reset: linenumber;
    }

    /* simple line numbers */
    pre.code > code {
      display:block;
    }
    pre.code > code > .line {
      display:block;
      padding-left:12px;
      padding-right:12px;
      position:relative;
      padding-left:50px;
    }
    pre.code > code > .line::before{
      counter-increment: linenumber;
      content: counter(linenumber);
      color:var(--muted);
      position:absolute;
      left:12px;
      width:32px;
      text-align:right;
      font-size:12px;
      top:0;
    }

    .status{
      font-size:13px;
      color:var(--muted);
    }

    .msg{
      margin-top:10px;color:var(--muted);font-size:13px;
    }

    @media (max-width:560px){
      .head{flex-direction:column;align-items:flex-start;gap:10px}
      .controls{width:100%;justify-content:space-between}
    }
  </style>
</head>
<body>
  <div class="wrap" role="main">
    <div class="head">
      <div class="title">
        <div class="logo">H</div>
        <div>
          <h1>HTML Source Viewer</h1>
          <p class="small">Preview the raw contents of <strong>friend.html</strong> safely (no scripts execute).</p>
        </div>
      </div>

      <div class="controls">
        <button id="viewBtn" class="btn" title="Fetch and show friend.html">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M4 4h16v6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M4 14h16v6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>
          View HTML
        </button>

        <button id="copyBtn" class="btn secondary" title="Copy shown code to clipboard" disabled>
          Copy
        </button>
      </div>
    </div>

    <div class="info-row">
      <div class="meta" id="meta">File: <strong>friend.html</strong></div>
      <div class="status" id="status">Idle</div>
    </div>

    <div class="viewer" id="viewer" aria-live="polite" aria-atomic="true">
      <pre class="code" id="codeBlock"><code id="codeContent"><span class="line">Click "View HTML" to fetch and display the contents of friend.html</span></code></pre>
    </div>

    <p class="msg">If nothing happens when you click View HTML, your browser may block fetching local files. Try starting a tiny local server in the same folder, e.g. <code>python -m http.server</code>, then open <code>http://localhost:8000/viewer.html</code>.</p>
  </div>

  <script>
    (function(){
      const viewBtn = document.getElementById('viewBtn');
      const copyBtn = document.getElementById('copyBtn');
      const status = document.getElementById('status');
      const codeContent = document.getElementById('codeContent');
      const meta = document.getElementById('meta');

      async function showStatus(txt, isError = false){
        status.textContent = txt;
        status.style.color = isError ? '#ffb4b4' : '';
      }

      function setCodeText(raw){
        // split into lines and wrap each with .line (for line numbers)
        const lines = raw.replace(/\r\n/g, '\n').split('\n');
        // escape HTML entities to show source safely
        const escapeHtml = (s) => s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
        codeContent.innerHTML = lines.map(l => `<span class="line">${escapeHtml(l) || ' '}</span>`).join('');
      }

      viewBtn.addEventListener('click', async () => {
        const target = 'friend.html';
        showStatus('Loading...');
        copyBtn.disabled = true;
        try{
          const resp = await fetch(target, {cache: 'no-store'});
          if(!resp.ok){
            throw new Error(`${resp.status} ${resp.statusText}`);
          }
          const text = await resp.text();
          setCodeText(text);

          // try to read headers for metadata (may be unavailable on file://)
          const lastMod = resp.headers.get('last-modified');
          const contentType = resp.headers.get('content-type') || 'text/html';
          const size = text.length;

          meta.innerHTML = `File: <strong>${target}</strong> — Type: ${contentType} ${lastMod ? ' — Last-Modified: ' + lastMod : ''} — Size: ${size} bytes`;
          showStatus('Loaded ✔');
          copyBtn.disabled = false;
        }catch(err){
          // friendly error message
          console.error(err);
          showStatus('Failed to load file — see console for details', true);

          // helpful hint for common case: file:// blocked by CORS
          const errMsg = [
            `Error: ${err.message}`,
            '',
            'Possible reasons:',
            '- You opened the page using file:// and your browser blocks fetch for local files.',
            '- friend.html is not in the same folder or the filename is different (check spelling).'
          ].join('\n');

          // show error formatted in viewer for convenience
          setCodeText(errMsg);
          copyBtn.disabled = true;
        }
      });

      copyBtn.addEventListener('click', async () => {
        // copy raw code (without line numbers)
        const lines = Array.from(codeContent.querySelectorAll('.line')).map(sp => sp.textContent.replace(/\u00A0/g,''));
        const raw = lines.join('\n');
        try{
          await navigator.clipboard.writeText(raw);
          showStatus('Copied to clipboard ✔');
          setTimeout(()=> showStatus('Loaded ✔'), 1200);
        }catch(e){
          showStatus('Copy failed', true);
          console.error(e);
        }
      });

      // Optional: allow opening by pressing Ctrl+O to fetch quickly
      document.addEventListener('keydown', (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 'o') {
          e.preventDefault();
          viewBtn.click();
        }
      });
    })();
  </script>
</body>
</html>
